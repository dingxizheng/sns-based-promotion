files: 
  "/etc/yum.repos.d/mongodb.repo":
    mode: "000644"
    content: |
      [MongoDB]
      name=MongoDB Repository
      baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64
      gpgcheck=0
      enabled=1
container_commands:
  01_enable_rootaccess:
    command: echo Defaults:root \!requiretty >> /etc/sudoers
  02_install_mongo:
    command: yum install -y mongo-10gen-server
    ignoreErrors: true
  03_config_mongo:
    command: mkdir -p /data/db && mkdir -p /var/log/mongo && touch /var/log/mongo/mongos.log
  04_turn_mongod_off:
    command: sudo chkconfig mongod off
  05_create_mongos_startup_script:
    command: sudo sh -c "echo '/usr/bin/mongod -configdb $MONGO_CONFIG_IPS -fork -logpath /var/log/mongo/mongos.log --logappend' > /etc/init.d/mongos.sh"
  06_update_mongos_startup_permissions:
    command: sudo chmod +x /etc/init.d/mongos.sh
  07_start_mongos:
    command: sudo bash /etc/init.d/mongos.sh