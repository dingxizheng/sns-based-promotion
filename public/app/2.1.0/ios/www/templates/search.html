<ion-view title="Search" hide-nav-bar="true">
    <ion-header-bar class="bar bar-header item-input-inset">
        <button ng-if="!goBackBtn" class="button button-icon icon ion-navicon" ng-click="toggleLeft()"></button>
        <button ng-if="goBackBtn" class="button button-icon icon ion-ios-arrow-back" ng-click="goBack()"></button>
        
        <label class="item-input-wrapper">
            <i class="icon ion-ios7-search placeholder-icon"></i>
            <input readonly ng-click="autoSuggest();false" type="search" placeholder="e.g. Vicinity Deals" ng-model="query">
        </label>
        <button class="button button-clear button-assertive" ng-click="search(query)" ng-class="{
                'disabled': !query || !query.trim().length > 1
            }">
                {{ lang.search.search_btn_name }}
        </button>

    </ion-header-bar>
    <div class="tabs-striped tabs-color-assertive">
        <ion-tabs delegate-handle="searchTabs">
            <ion-tab title="{{ lang.search.tab_title_business }}" on-select="onTabSelect(0)">
                <ion-view>
                    <ion-content class="has-header" style="background-color: #fff">
                        <ion-list ng-if="!isEmpty(0)">
                            <gampcard ng-if="results[0].normal && results[0].normal.length > 0" mycard ng-repeat="item in results[0].normal" ng-model="item.result" templateUrl="{{ item.class=='User' ? 'user.html' : 'promotion.html' }}"></gampcard>
                        </ion-list>

                        <ion-list ng-if="isEmpty(0)">
                            <div class="item item-image" style="margin: 2vw 2vw; border: none">
                                <img ng-src="http://placehold.it/500x100/ffffff/dedede?text={{ lang.search.no_result_text_dealers }}" />
                            </div>
                            <li ng-if="isEmpty(0)" class="item item-divider">
                                {{ lang.search.suggested_dealers }}
                            </li>
                            <!-- regular results -->
                            <gampcard ng-if="isEmpty(0)" mycard ng-repeat="item in suggested_dealers" ng-model="item" templateUrl="{{ 'user.html' }}"></gampcard>
                        </ion-list>

                        <button ng-if="!isEmpty(0) && !search_done[0]" ng-click="loadNext(0)" class="button button-full button-clear button-dark" style="margin-top: none">
                          Load More <i class="ion-ios-reload"></i>
                        </button>
   
                    </ion-content>
                </ion-view>
            </ion-tab>
            <ion-tab title="{{ lang.search.tab_title_deals }}" on-select="onTabSelect(1)">
                <ion-view>
                    <ion-content class="has-header" style="background-color: #fff">

                        <ion-list ng-if="!isEmpty(1)">
                            <gampcard ng-if="results[1].normal && results[1].normal.length > 0" mycard ng-repeat="item in results[1].normal" ng-model="item.result" templateUrl="{{ item.class=='User' ? 'user.html' : 'promotion.html' }}"></gampcard>
                        </ion-list>

                        <ion-list ng-if="isEmpty(1)">

                            <div class="item item-image" style="margin: 2vw 2vw; border: none">
                                <img ng-src="http://placehold.it/500x100/ffffff/dedede?text={{ lang.search.no_result_text_deals }}" />
                            </div>
                            <li ng-if="isEmpty(1)" class="item item-divider">
                                {{ lang.search.suggested_deals }}
                            </li>
                            <!-- regular results -->
                            <gampcard ng-if="isEmpty(1)" mycard ng-repeat="item in suggested_promotions" ng-model="item" templateUrl="{{ 'promotion.html' }}"></gampcard>
                        </ion-list>
                        
                        <button ng-if="!isEmpty(1) && !search_done[1]" ng-click="loadNext(1)" class="button button-full button-clear button-dark" style="margin-top: none">
                          Load More <i class="ion-ios-reload"></i>
                        </button>

                    </ion-content>
                </ion-view>
            </ion-tab>
            <ion-tab title="{{ lang.search.tab_title_options }}" on-select="onTabSelect(2)" class="button-postive" ng-controller="SearchSetttingsCtrl">
                <ul class="list">
                    <li class="item item-divider">
                        {{ settingslang.search.options_location + ' within ' + settings.distance + ' kms'}}
                    </li>
                    <!-- <li class="item item-toggle">
                        {{ settingslang.search.options_location_toggle_name }} <span style="color: rgb(226, 125, 125); font-size: x-small"> within {{ settings.distance }} kms</span>
                        <label class="toggle toggle-assertive">
                            <input type="checkbox" checked ng-model="settings.enable" ng-change="update()">
                            <div class="track">
                                <div class="handle"></div>
                            </div>
                        </label>
                    </li> -->
                    <li class="item range range-assertive">
                        0.5 km
                        <input type="range" name="volume" min="0.5" max="200" ng-model="settings.distance" ng-change="update()">
                        <!-- <input ng-if="!settings.enable" type="range" name="volume" min="0.5" max="200" ng-model="settings.distance" ng-change="update()" disabled> 200 km -->
                    </li>
                    <li class="item item-divider">
                        {{ settingslang.search.options_sort }}
                    </li>

                    <ion-radio ng-model="settings.sortBy" value="score" ng-change="update()">Most Relevant First (default)</ion-radio>

                    <ion-radio ng-model="settings.sortBy" value="distance" ng-change="update()">Nearest First</ion-radio>

                    <ion-radio ng-model="settings.sortBy" value="rating" ng-change="update()">Highest Rating First</ion-radio>

                    <ion-radio ng-model="settings.sortBy" value="start" ng-change="update()">Most Recent First</ion-radio>

                </ul>
                </ion-content>
            </ion-tab>
        </ion-tabs>
    </div>
</ion-view>
